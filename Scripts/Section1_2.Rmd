---
title: "Section: *Saccharomyces* species differ in thermal performance"
author: "Jennifer Molinet"
date: "2025-02-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Libraries**

```{r}
suppressMessages(library(tidyverse))
library(ggplot2)
suppressMessages(library(reshape2))
library(rTPC)
library(nls.multstart)
library(broom)
library(minpack.lm)
library(ggpubr)
```

**Directories**

```{r}
output_dir <- "../results/Section1/"
input_dir <- "../data/Section1"
```

**Loading data**
```{r}
file_path <- file.path(input_dir, "Kinetic_parameters.txt")
datos <- read.table(file_path, header = TRUE, stringsAsFactors = FALSE)
head(datos)
```


**Generating thermal performance curves (TPCs)**

We fitted TPCs of each strain by plotting the maximum growth rate against temperature.

```{r}
datos$Temperature <- as.numeric(datos$Temperature)
datos$Specie <- ordered(datos$Specie, levels = c("SE", "SU", "SA", "SK", "SJ","SM","SP","SC"))

colnames(datos) <- c("Strain", "Replicate","Specie","temp","ave_rate","OD")
head(datos)
```
```{r}
d_ave <- datos %>% filter(temp != "23") %>%
  group_by(Strain,Specie,temp) %>%
  dplyr::summarise(., sd = sd(ave_rate),
            ave_rate = mean(ave_rate)) %>%
  ungroup()
head(d_ave)
```
TPCs were fitted using the cardinal temperature model with inflection (CTMI).

```{r}
CTMI <- function(T, T_min, T_opt, T_max, R_opt) {
  R <- ifelse(T <= T_min | T >= T_max, 0,
              R_opt * ((T - T_max) * (T - T_min)^2) / ((T_opt - T_min) * ((T_opt - T_min) * (T - T_opt) - (T_opt - T_max) * (T_opt + T_min - 2 * T))))
  return(R)
}
```

*S. eubayanus*

Se-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Se-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
             start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)

SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.02616
R2 <- 1 - (SSR / SST)
R2
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

Se-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Se-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```


```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001223
R2 <- 1 - (SSR / SST)
R2
```

Se-3 strain
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Se-3") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.00009159
R2 <- 1 - (SSR / SST)
R2
```

Se-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Se-4") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-4') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002898
R2 <- 1 - (SSR / SST)
R2
```

Se-5
```{r}
d_ave5 <- d_ave %>% filter(Strain == "Se-5") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave5$temp %>% unlist()
R_observed <- d_ave5$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit5 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit5

# Extract parameter estimates
params5 <- coef(fit5) 

# Validate the model fit
summary(fit5)
calc_params(fit5)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted5 <- CTMI(T_new, params5["T_min"], params5["T_opt"], params5["T_max"], params5["R_opt"])

# Visualize the results
R_predicted5 <- data.frame(T=T_new, Rate = R_predicted5) 

ggplot(R_predicted5) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-5') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.00104
R2 <- 1 - (SSR / SST)
R2
```

Se-6 strain
```{r}
d_ave6 <- d_ave %>% filter(Strain == "Se-6") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave6$temp %>% unlist()
R_observed <- d_ave6$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit6 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit6

# Extract parameter estimates
params6 <- coef(fit6) 

# Validate the model fit
summary(fit6)
calc_params(fit6)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted6 <- CTMI(T_new, params6["T_min"], params6["T_opt"], params6["T_max"], params6["R_opt"])

# Visualize the results
R_predicted6 <- data.frame(T=T_new, Rate = R_predicted6) 

ggplot(R_predicted6) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-6') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.000908
R2 <- 1 - (SSR / SST)
R2
```

All *S. eubayanus* strains: Plotting figure S4A

```{r figureS4A, fig.width=6, fig.height=6}
SE <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#9ECAE1") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#6BAED6",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#4292C6",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#2171B5",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#08519C",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#08306B",R_predicted6) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#9ECAE1")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="#6BAED6")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#4292C6")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#2171B5")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="#08519C")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="#08306B")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#9ECAE1") +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#6BAED6") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#4292C6") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#2171B5") +
  geom_point(data=data.frame(Topt=params5["T_opt"],Ropt= params5["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#08519C") +
  geom_point(data=data.frame(Topt=params6["T_opt"],Ropt= params6["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#08306B") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. eubayanus')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SE
ggsave(filename = file.path(output_dir, "Figure_S4A.tiff"), plot = SE, width = 6, height = 6, dpi = 300)
```

Plotting figure 7A

```{r figureS7A, fig.width=6, fig.height=6}
SE2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#9ECAE1") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#08306B",R_predicted6) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#9ECAE1") +
  geom_point(data=data.frame(Topt=params6["T_opt"],Ropt= params6["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#08306B") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. eubayanus')+
  annotate("text",x=31,y=0.5,label="Se-1",fontface="bold",size=5, color="#9ECAE1",hjust = 0)+
  annotate("text",x=28,y=0.3,label="Se-2",fontface="bold",size=5, color="#08306B",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SE2

ggsave(filename = file.path(output_dir, "Figure_S7A.tiff"), plot = SE2, width = 6, height = 6, dpi = 300)
```
*S. uvarum*

Su-1 strain

```{r}
d_ave1 <- d_ave %>% filter(Strain == "Su-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Su-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0005037
R2 <- 1 - (SSR / SST)
R2
```

Su-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Su-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Su-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001652
R2 <- 1 - (SSR / SST)
R2
```

Su-3
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Su-3") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Su-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002262
R2 <- 1 - (SSR / SST)
R2
```

Su-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Su-4") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Su-4') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002018
R2 <- 1 - (SSR / SST)
R2
```

All the *S. uvarum* strains: Plotting figure S4B
```{r figureS4B, fig.width=6, fig.height=6}
SU <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#BFD3E6" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#8C96C6",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#88419D",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#4D004B",R_predicted4) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#BFD3E6" )+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="#8C96C6")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#88419D")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#4D004B")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=30.14,y=0.490), size = 4,  color="#BFD3E6" ) +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#8C96C6") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#88419D") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#4D004B") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h',
       title = 'S. uvarum')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SU
ggsave(filename = file.path(output_dir, "Figure_S4B.tiff"), plot = SU, width = 6, height = 6, dpi = 300)
```

Plotting figure S7B
```{r figureS7B, fig.width=6, fig.height=6}
SU2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#8C96C6",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#4D004B",R_predicted4) +
  #Topt
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#8C96C6") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#4D004B") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. uvarum')+
  annotate("text",x=33,y=0.5,label="Su-2",fontface="bold",size=5, color="#8C96C6",hjust = 0)+
  annotate("text",x=22,y=0.45,label="Su-4",fontface="bold",size=5, color="#4D004B",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SU2
ggsave(filename = file.path(output_dir, "Figure_S7B.tiff"), plot = SU2, width = 6, height = 6, dpi = 300)
```
*S. arboricola*

Sa-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Sa-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sa-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.00144
R2 <- 1 - (SSR / SST)
R2
```

Sa-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Sa-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sa-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001101
R2 <- 1 - (SSR / SST)
R2
```

Sa-3 strain
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Sa-3", temp != "16") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sa-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001428
R2 <- 1 - (SSR / SST)
R2
```

Sa-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Sa-4", temp != "20") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sa-4') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.000004153
R2 <- 1 - (SSR / SST)
R2
```

All the *S. arboricola* strains

```{r figureS4C, fig.width=6, fig.height=6}
SA <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#99D8C9" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#66C2A4",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#238B45",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#00441B",R_predicted4) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#99D8C9" )+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="#66C2A4")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#238B45")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#00441B")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#99D8C9" ) +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#66C2A4") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#238B45") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#00441B") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. arboricola')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SA
ggsave(filename = file.path(output_dir, "Figure_S4C.tiff"), plot = SA, width = 6, height = 6, dpi = 300)
```


```{r figureS7C, fig.width=6, fig.height=6}
SA2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#00441B",R_predicted4) +
  #Topt
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#00441B") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. arboricola')+
  annotate("text",x=32,y=0.35,label="Sa-4",fontface="bold",size=5, color="#00441B",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.7))
SA2
ggsave(filename = file.path(output_dir, "Figure_S7C.tiff"), plot = SA2, width = 6, height = 6, dpi = 300)
```
*S. kudriavzevii*

Sk-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Sk-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sk-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.000176
R2 <- 1 - (SSR / SST)
R2
```

```{r}
# Strain-2
d_ave2 <- d_ave %>% filter(Strain == "Sk-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sk-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0009441
R2 <- 1 - (SSR / SST)
R2
```

Sk-3 strain
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Sk-3") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sk-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0008525
R2 <- 1 - (SSR / SST)
R2
```

Sk-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Sk-4") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Se-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001925
R2 <- 1 - (SSR / SST)
R2
```


All the *S. kudriavzevii* strains: Plotting figure S4D

```{r figureS4D, fig.width=6, fig.height=6}
SK <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#A8DDB5" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#7BCCC4",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#2B8CBE",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#084081",R_predicted4) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#A8DDB5" )+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="#7BCCC4")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#2B8CBE")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#084081")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#A8DDB5" ) +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#7BCCC4") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#2B8CBE") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#084081") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. kudriavzevii')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SK
ggsave(filename = file.path(output_dir, "Figure_S4D.tiff"), plot = SK, width = 6, height = 6, dpi = 300)
```

Plotting figure S7D
```{r figureS7D, fig.width=6, fig.height=6}
SK2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#A8DDB5" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#084081",R_predicted4) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#A8DDB5" ) +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#084081") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. kudriavzevii')+
  annotate("text",x=28,y=0.41,label="Sk-1",fontface="bold",size=5, color="#A8DDB5",hjust = 0)+
  annotate("text",x=31,y=0.31,label="Sk-2",fontface="bold",size=5, color="#084081",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SK2
ggsave(filename = file.path(output_dir, "Figure_S7D.tiff"), plot = SK2, width = 6, height = 6, dpi = 300)
```
*S. jurei*

Sj-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Sj-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'Growth rate across temperatures for Sj-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0006994
R2 <- 1 - (SSR / SST)
R2
```

Sj-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Sj-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sj-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.01323
R2 <- 1 - (SSR / SST)
R2
```

All the *S.jurei* strains: plotting figure 4E

```{r figureS4E, fig.width=6, fig.height=6}
SJ <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#737373" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#252525",R_predicted2) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#737373" )+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="#252525")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#737373" ) +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=30.38,y=0.559), size = 4,  color="#252525") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. jurei')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SJ
ggsave(filename = file.path(output_dir, "Figure_S4E.tiff"), plot = SJ, width = 6, height = 6, dpi = 300)
```

Plotting figure 7E
```{r figureS7E, fig.width=6, fig.height=6}
SJ2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#737373" ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#252525",R_predicted2) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#737373" ) +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=30.38,y=0.559), size = 4,  color="#252525") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. jurei')+
  annotate("text",x=35,y=0.5,label="Sj-1",fontface="bold",size=5, color="#737373",hjust = 0)+
  annotate("text",x=31,y=0.61,label="Sj-2",fontface="bold",size=5, color="#252525",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SJ2
ggsave(filename = file.path(output_dir, "Figure_S7E.tiff"), plot = SJ2, width = 6, height = 6, dpi = 300)
```
*S. mikatae*

Sm-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Sm-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```
```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'Growth rate across temperatures for Sm-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0003757
R2 <- 1 - (SSR / SST)
R2
```


Sm-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Sm-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'Growth rate across temperatures for Sm-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002301
R2 <- 1 - (SSR / SST)
R2
```

Sm-3 strain
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Sm-3") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sm-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.02835
R2 <- 1 - (SSR / SST)
R2
```

Sm-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Sm-4") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sm-4') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.01243
R2 <- 1 - (SSR / SST)
R2
```

Sm-5 strain
```{r}
d_ave5 <- d_ave %>% filter(Strain == "Sm-5") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave5$temp %>% unlist()
R_observed <- d_ave5$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit5 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit5

# Extract parameter estimates
params5 <- coef(fit5) 

# Validate the model fit
summary(fit5)
calc_params(fit5)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted5 <- CTMI(T_new, params5["T_min"], params5["T_opt"], params5["T_max"], params5["R_opt"])

# Visualize the results
R_predicted5 <- data.frame(T=T_new, Rate = R_predicted5) 

ggplot(R_predicted5) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sm-5') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.02646
R2 <- 1 - (SSR / SST)
R2
```

Sm-6 strain
```{r}
d_ave6 <- d_ave %>% filter(Strain == "Sm-6", temp != "20") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave6$temp %>% unlist()
R_observed <- d_ave6$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit6 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit6

# Extract parameter estimates
params6 <- coef(fit6) 

# Validate the model fit
summary(fit6)
calc_params(fit6)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted6 <- CTMI(T_new, params6["T_min"], params6["T_opt"], params6["T_max"], params6["R_opt"])

# Visualize the results
R_predicted6 <- data.frame(T=T_new, Rate = R_predicted6) 

ggplot(R_predicted6) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sm-6') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0006847
R2 <- 1 - (SSR / SST)
R2
```

All the *S. mikatae* strains: plotting figure S4F
```{r figureS4F, fig.width=6, fig.height=6}
SM <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#C994C7") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#DF65B0",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#E7298A",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#CE1256",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#980043",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#67001F",R_predicted6) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#C994C7")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = "#DF65B0")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#E7298A")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#CE1256")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="#980043")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="#67001F")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#C994C7") +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#DF65B0") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#E7298A") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#CE1256") +
  geom_point(data=data.frame(Topt=params5["T_opt"],Ropt= params5["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#980043") +
  geom_point(data=data.frame(Topt=params6["T_opt"],Ropt= params6["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#67001F") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. mikatae')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SM
ggsave(filename = file.path(output_dir, "Figure_S4F.tiff"), plot = SM, width = 6, height = 6, dpi = 300)
```

Plotting figure S7F
```{r figureS7F, fig.width=6, fig.height=6}
SM2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#C994C7") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#67001F",R_predicted6) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#C994C7") +
  geom_point(data=data.frame(Topt=params6["T_opt"],Ropt= params6["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#67001F") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. mikatae')+
  annotate("text",x=23,y=0.53,label="Sm-1",fontface="bold",size=5, color="#C994C7",hjust = 0)+
  annotate("text",x=30,y=0.67,label="Sm-6",fontface="bold",size=5, color="#67001F",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SM2
ggsave(filename = file.path(output_dir, "Figure_S7C.tiff"), plot = SA2, width = 6, height = 6, dpi = 300)
```
*S. paradoxus*

Sp-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Sp-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0006275
R2 <- 1 - (SSR / SST)
R2
```

Sp-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Sp-2") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-2') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0005904
R2 <- 1 - (SSR / SST)
R2
```

Sp-3
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Sp-3") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```


```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.01928
R2 <- 1 - (SSR / SST)
R2
```

Sp-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Sp-4") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-4') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.004184
R2 <- 1 - (SSR / SST)
R2
```

Sp-5 strain
```{r}
d_ave5 <- d_ave %>% filter(Strain == "Sp-5") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave5$temp %>% unlist()
R_observed <- d_ave5$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit5 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit5

# Extract parameter estimates
params5 <- coef(fit5) 

# Validate the model fit
summary(fit5)
calc_params(fit5)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted5 <- CTMI(T_new, params5["T_min"], params5["T_opt"], params5["T_max"], params5["R_opt"])

# Visualize the results
R_predicted5 <- data.frame(T=T_new, Rate = R_predicted5) 

ggplot(R_predicted5) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-5') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.004008
R2 <- 1 - (SSR / SST)
R2
```

Sp-6 strain
```{r}
d_ave6 <- d_ave %>% filter(Strain == "Sp-6", temp != "18") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave6$temp %>% unlist()
R_observed <- d_ave6$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit6 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit6

# Extract parameter estimates
params6 <- coef(fit6) 

# Validate the model fit
summary(fit6)
calc_params(fit6)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted6 <- CTMI(T_new, params6["T_min"], params6["T_opt"], params6["T_max"], params6["R_opt"])

# Visualize the results
R_predicted6 <- data.frame(T=T_new, Rate = R_predicted6) 

ggplot(R_predicted6) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-6') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002438
R2 <- 1 - (SSR / SST)
R2
```

Sp-7 strain
```{r}
d_ave7 <- d_ave %>% filter(Strain == "Sp-7") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave7) +
  geom_point(aes(temp, ave_rate), d_ave7, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave7$temp %>% unlist()
R_observed <- d_ave7$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit7 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit7

# Extract parameter estimates
params7 <- coef(fit7) 

# Validate the model fit
summary(fit7)
calc_params(fit7)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted7 <- CTMI(T_new, params7["T_min"], params7["T_opt"], params7["T_max"], params7["R_opt"])

# Visualize the results
R_predicted7 <- data.frame(T=T_new, Rate = R_predicted7) 

ggplot(R_predicted7) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave7, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave7) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-7') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```
```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002371
R2 <- 1 - (SSR / SST)
R2
```

Sp-8 strain
```{r}
d_ave8 <- d_ave %>% filter(Strain == "Sp-8") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave8) +
  geom_point(aes(temp, ave_rate), d_ave8, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave8$temp %>% unlist()
R_observed <- d_ave8$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit8 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit8

# Extract parameter estimates
params8 <- coef(fit8) 

# Validate the model fit
summary(fit8)
calc_params(fit8)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted8 <- CTMI(T_new, params8["T_min"], params8["T_opt"], params8["T_max"], params8["R_opt"])

# Visualize the results
R_predicted8 <- data.frame(T=T_new, Rate = R_predicted8) 

ggplot(R_predicted8) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave8, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave8) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-8') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001944
R2 <- 1 - (SSR / SST)
R2
```

Sp-9 strain
```{r}
d_ave9 <- d_ave %>% filter(Strain == "Sp-9") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave9) +
  geom_point(aes(temp, ave_rate), d_ave9, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave9$temp %>% unlist()
R_observed <- d_ave9$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit9 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit9

# Extract parameter estimates
params9 <- coef(fit9) 

# Validate the model fit
summary(fit9)
calc_params(fit9)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted9 <- CTMI(T_new, params9["T_min"], params9["T_opt"], params9["T_max"], params9["R_opt"])

# Visualize the results
R_predicted9 <- data.frame(T=T_new, Rate = R_predicted9) 

ggplot(R_predicted9) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave9, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave9) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sp-9') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002111
R2 <- 1 - (SSR / SST)
R2
```

All the *S. paradoxus* strains: plotting figure 4G

```{r figureS4G, fig.width=6, fig.height=6}
SP <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FFF5EB") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FEE6CE",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FDD0A2",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FDAE6B",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FD8D3C",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#F16913",R_predicted6) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#D94801",R_predicted7) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#A63603",R_predicted8) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#7F2704",R_predicted9) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#FFF5EB")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = "#FEE6CE")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#FDD0A2")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#FDAE6B")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="#FD8D3C")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="#F16913")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  geom_point(aes(temp, ave_rate), d_ave7, size = 2, shape = 21, fill ="#D94801")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave7) +
  geom_point(aes(temp, ave_rate), d_ave8, size = 2, shape = 21, fill ="#A63603")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave8) +
  geom_point(aes(temp, ave_rate), d_ave9, size = 2, shape = 21, fill ="#7F2704")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave9) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FFF5EB") +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FEE6CE") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FDD0A2") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FDAE6B") +
  geom_point(data=data.frame(Topt=params5["T_opt"],Ropt= params5["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FD8D3C") +
  geom_point(data=data.frame(Topt=params6["T_opt"],Ropt= params6["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#F16913") +
  geom_point(data=data.frame(Topt=params7["T_opt"],Ropt= params7["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#D94801") +
  geom_point(data=data.frame(Topt=params8["T_opt"],Ropt= params8["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#A63603") +
  geom_point(data=data.frame(Topt=params9["T_opt"],Ropt= params9["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#7F2704") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. paradoxus')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SP
ggsave(filename = file.path(output_dir, "Figure_S4G.tiff"), plot = SP, width = 6, height = 6, dpi = 300)
```

Plotting figure 7G

```{r figureS7G, fig.width=6, fig.height=6}
SP2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#FD8D3C",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted6) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted7) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#A63603",R_predicted8) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted9) +
  #Topt
  geom_point(data=data.frame(Topt=params5["T_opt"],Ropt= params5["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FD8D3C") +
  geom_point(data=data.frame(Topt=params8["T_opt"],Ropt= params8["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#A63603") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. paradoxus')+
  annotate("text",x=32,y=0.65,label="Sp-1",fontface="bold",size=5, color="#FD8D3C",hjust = 0)+
  annotate("text",x=30,y=0.32,label="Sp-2",fontface="bold",size=5, color="#A63603",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SP2
ggsave(filename = file.path(output_dir, "Figure_S7G.tiff"), plot = SP2, width = 6, height = 6, dpi = 300)
```
*S. cerevisiae*

Sc-1 strain
```{r}
d_ave1 <- d_ave %>% filter(Strain == "Sc-1") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave1$temp %>% unlist()
R_observed <- d_ave1$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit1 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit1

# Extract parameter estimates
params1 <- coef(fit1)

# Validate the model fit
summary(fit1)
calc_params(fit1)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted1 <- CTMI(T_new, params1["T_min"], params1["T_opt"], params1["T_max"], params1["R_opt"])

# Visualize the results
R_predicted1 <- data.frame(T=T_new, Rate = R_predicted1) 

ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0003902
R2 <- 1 - (SSR / SST)
R2
```

Sc-2 strain
```{r}
d_ave2 <- d_ave %>% filter(Strain == "Sc-2", temp != "34") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave2$temp %>% unlist()
R_observed <- d_ave2$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit2 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit2

# Extract parameter estimates
params2 <- coef(fit2) 

# Validate the model fit
summary(fit2)
calc_params(fit2)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted2 <- CTMI(T_new, params2["T_min"], params2["T_opt"], params2["T_max"], params2["R_opt"])

# Visualize the results
R_predicted2 <- data.frame(T=T_new, Rate = R_predicted2) 

ggplot(R_predicted2) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-1') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.008314
R2 <- 1 - (SSR / SST)
R2
```

Sc-3 strain
```{r}
d_ave3 <- d_ave %>% filter(Strain == "Sc-3") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave3$temp %>% unlist()
R_observed <- d_ave3$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit3 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit3

# Extract parameter estimates
params3 <- coef(fit3) 

# Validate the model fit
summary(fit3)
calc_params(fit3)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted3 <- CTMI(T_new, params3["T_min"], params3["T_opt"], params3["T_max"], params3["R_opt"])

# Visualize the results
R_predicted3 <- data.frame(T=T_new, Rate = R_predicted3) 

ggplot(R_predicted3) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-3') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.005742
R2 <- 1 - (SSR / SST)
R2
```

Sc-4 strain
```{r}
d_ave4 <- d_ave %>% filter(Strain == "Sc-4", temp != "20") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave4$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit4 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit4

# Extract parameter estimates
params4 <- coef(fit4) 

# Validate the model fit
summary(fit4)
calc_params(fit4)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted4 <- CTMI(T_new, params4["T_min"], params4["T_opt"], params4["T_max"], params4["R_opt"])

# Visualize the results
R_predicted4 <- data.frame(T=T_new, Rate = R_predicted4) 

ggplot(R_predicted4) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-4') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0009123
R2 <- 1 - (SSR / SST)
R2
```

Sc-5 strain
```{r}
d_ave5 <- d_ave %>% filter(Strain == "Sc-5", temp != "31") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave5$temp %>% unlist()
R_observed <- d_ave5$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit5 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit5

# Extract parameter estimates
params5 <- coef(fit5) 

# Validate the model fit
summary(fit5)
calc_params(fit5)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted5 <- CTMI(T_new, params5["T_min"], params5["T_opt"], params5["T_max"], params5["R_opt"])

# Visualize the results
R_predicted5 <- data.frame(T=T_new, Rate = R_predicted5) 

ggplot(R_predicted5) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-5') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0002531
R2 <- 1 - (SSR / SST)
R2
```

Sc-6 strain
```{r}
d_ave6 <- d_ave %>% filter(Strain == "Sc-6") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave6$temp %>% unlist()
R_observed <- d_ave6$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit6 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit6

# Extract parameter estimates
params6 <- coef(fit6) 

# Validate the model fit
summary(fit6)
calc_params(fit6)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted6 <- CTMI(T_new, params6["T_min"], params6["T_opt"], params6["T_max"], params6["R_opt"])

# Visualize the results
R_predicted6 <- data.frame(T=T_new, Rate = R_predicted6) 

ggplot(R_predicted6) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-6') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002021
R2 <- 1 - (SSR / SST)
R2
```

Sc-7 strain
```{r}
d_ave7 <- d_ave %>% filter(Strain == "Sc-7") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave7) +
  geom_point(aes(temp, ave_rate), d_ave7, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave7$temp %>% unlist()
R_observed <- d_ave7$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit7 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit7

# Extract parameter estimates
params7 <- coef(fit7) 

# Validate the model fit
summary(fit7)
calc_params(fit7)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted7 <- CTMI(T_new, params7["T_min"], params7["T_opt"], params7["T_max"], params7["R_opt"])

# Visualize the results
R_predicted7 <- data.frame(T=T_new, Rate = R_predicted7) 

ggplot(R_predicted7) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave7, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave7) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-7') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.0039
R2 <- 1 - (SSR / SST)
R2
```

Sc-8 strain
```{r}
d_ave8 <- d_ave %>% filter(Strain == "Sc-8") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave8) +
  geom_point(aes(temp, ave_rate), d_ave8, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave8$temp %>% unlist()
R_observed <- d_ave8$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit8 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit8

# Extract parameter estimates
params8 <- coef(fit8) 

# Validate the model fit
summary(fit8)
calc_params(fit8)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted8 <- CTMI(T_new, params8["T_min"], params8["T_opt"], params8["T_max"], params8["R_opt"])

# Visualize the results
R_predicted8 <- data.frame(T=T_new, Rate = R_predicted8) 

ggplot(R_predicted8) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave8, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave8) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-8') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.007552
R2 <- 1 - (SSR / SST)
R2
```

Sc-9 strain
```{r}
d_ave9 <- d_ave %>% filter(Strain == "Sc-9", temp != "18") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave9) +
  geom_point(aes(temp, ave_rate), d_ave9, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave9$temp %>% unlist()
R_observed <- d_ave9$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit9 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit9

# Extract parameter estimates
params9 <- coef(fit9) 

# Validate the model fit
summary(fit9)
calc_params(fit9)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted9 <- CTMI(T_new, params9["T_min"], params9["T_opt"], params9["T_max"], params9["R_opt"])

# Visualize the results
R_predicted9 <- data.frame(T=T_new, Rate = R_predicted9) 

ggplot(R_predicted9) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave9, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave9) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-9') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.003384
R2 <- 1 - (SSR / SST)
R2
```

Sc-10 strain
```{r}
d_ave10 <- d_ave %>% filter(Strain == "Sc-10") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave10) +
  geom_point(aes(temp, ave_rate), d_ave10, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave10$temp %>% unlist()
R_observed <- d_ave10$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit10 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit10

# Extract parameter estimates
params10 <- coef(fit10)

# Validate the model fit
summary(fit10)
calc_params(fit10)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted10 <- CTMI(T_new, params10["T_min"], params10["T_opt"], params10["T_max"], params10["R_opt"])

# Visualize the results
R_predicted10 <- data.frame(T=T_new, Rate = R_predicted10) 

ggplot(R_predicted10) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave10, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave10) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-10') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002411
R2 <- 1 - (SSR / SST)
R2
```

Sc-11 strain
```{r}
d_ave11 <- d_ave %>% filter(Strain == "Sc-11") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave11) +
  geom_point(aes(temp, ave_rate), d_ave11, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave11$temp %>% unlist()
R_observed <- d_ave11$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit11 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit11

# Extract parameter estimates
params11 <- coef(fit11)

# Validate the model fit
summary(fit11)
calc_params(fit11)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted11 <- CTMI(T_new, params11["T_min"], params11["T_opt"], params11["T_max"], params11["R_opt"])

# Visualize the results
R_predicted11 <- data.frame(T=T_new, Rate = R_predicted11) 

ggplot(R_predicted11) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave11, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave11) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-11') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002509
R2 <- 1 - (SSR / SST)
R2
```

Sc-12 strain
```{r}
d_ave12 <- d_ave %>% filter(Strain == "Sc-12") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave12) +
  geom_point(aes(temp, ave_rate), d_ave12, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave12$temp %>% unlist()
R_observed <- d_ave12$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit12 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 30, T_max = 37, R_opt = 0.5))  # Adjusted starting value for 'c'
fit12

# Extract parameter estimates
params12 <- coef(fit12) 

# Validate the model fit
summary(fit12)
calc_params(fit12)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted12 <- CTMI(T_new, params12["T_min"], params12["T_opt"], params12["T_max"], params12["R_opt"])

# Visualize the results
R_predicted12 <- data.frame(T=T_new, Rate = R_predicted12) 

ggplot(R_predicted12) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave12, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave12) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-12') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.002152
R2 <- 1 - (SSR / SST)
R2
```

Sc-13 strain
```{r}
d_ave13 <- d_ave %>% filter(Strain == "Sc-13") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave13) +
  geom_point(aes(temp, ave_rate), d_ave13, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave13$temp %>% unlist()
R_observed <- d_ave13$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit13 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 30, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit13

# Extract parameter estimates
params13 <- coef(fit13) 

# Validate the model fit
summary(fit13)
calc_params(fit13)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted13 <- CTMI(T_new, params13["T_min"], params13["T_opt"], params13["T_max"], params13["R_opt"])

# Visualize the results
R_predicted13 <- data.frame(T=T_new, Rate = R_predicted13) 

ggplot(R_predicted13) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave13, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave13) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-13') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.005805
R2 <- 1 - (SSR / SST)
R2
```

Sc-14 strain
```{r}
d_ave14 <- d_ave %>% filter(Strain == "Sc-14", temp %in% c("16","18","20","25","31","34","37","40")) 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave14) +
  geom_point(aes(temp, ave_rate), d_ave14, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave4$temp %>% unlist()
R_observed <- d_ave14$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit14 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit14

# Extract parameter estimates
params14 <- coef(fit14) 

# Validate the model fit
summary(fit14)
calc_params(fit14)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted14 <- CTMI(T_new, params14["T_min"], params14["T_opt"], params14["T_max"], params14["R_opt"])

# Visualize the results
R_predicted14 <- data.frame(T=T_new, Rate = R_predicted14) 

ggplot(R_predicted14) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave14, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave14) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-14') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.02689
R2 <- 1 - (SSR / SST)
R2
```

Sc-15 strain
```{r}
d_ave15 <- d_ave %>% filter(Strain == "Sc-15") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave15) +
  geom_point(aes(temp, ave_rate), d_ave15, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave15$temp %>% unlist()
R_observed <- d_ave15$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit15 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit15

# Extract parameter estimates
params15 <- coef(fit15) 

# Validate the model fit
summary(fit15)
calc_params(fit15)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted15 <- CTMI(T_new, params15["T_min"], params15["T_opt"], params15["T_max"], params15["R_opt"])

# Visualize the results
R_predicted15 <- data.frame(T=T_new, Rate = R_predicted15) 

ggplot(R_predicted15) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave15, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave15) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-15') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001233
R2 <- 1 - (SSR / SST)
R2
```

Sc-16 strain
```{r}
d_ave16 <- d_ave %>% filter(Strain == "Sc-16") 

ggplot() +
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave16) +
  geom_point(aes(temp, ave_rate), d_ave16, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)
```

```{r}
T <- d_ave16$temp %>% unlist()
R_observed <- d_ave16$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit16 <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))  # Adjusted starting value for 'c'
fit16

# Extract parameter estimates
params16 <- coef(fit16) 

# Validate the model fit
summary(fit16)
calc_params(fit16)
```

```{r}
# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted16 <- CTMI(T_new, params16["T_min"], params16["T_opt"], params16["T_max"], params16["R_opt"])

# Visualize the results
R_predicted16 <- data.frame(T=T_new, Rate = R_predicted16) 

ggplot(R_predicted16) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), d_ave16, size = 2, shape = 21, fill ="black")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave16) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for Sc-16') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

```{r}
SST <- sum((R_observed - mean(R_observed))^2)
SSR <- 0.001846
R2 <- 1 - (SSR / SST)
R2
```


All the *S. cerevisiae* strains: plotting figure S4H

```{r figureS4H, fig.width=6, fig.height=6}
SC <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FFF5F0") +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FEE0D2",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FFFFCC",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FFEDA0",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FCBBA1",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FC9272",R_predicted6) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FD8D3C",R_predicted7) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FB6A4A",R_predicted8) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#EF3B2C",R_predicted9) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#FC4E2A",R_predicted10) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#E31A1C",R_predicted11) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#CB181D",R_predicted12) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#A50F15",R_predicted13) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#BD0026",R_predicted14) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#800026",R_predicted15) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="#67000D",R_predicted16) +
  #Datos
  geom_point(aes(temp, ave_rate), d_ave1, size = 2, shape = 21, fill ="#FFF5F0")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave1) +
  geom_point(aes(temp, ave_rate), d_ave2, size = 2, shape = 21, fill = "#FEE0D2")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave2) +
  geom_point(aes(temp, ave_rate), d_ave3, size = 2, shape = 21, fill ="#FFFFCC")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave3) +
  geom_point(aes(temp, ave_rate), d_ave4, size = 2, shape = 21, fill ="#FFEDA0")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave4) +
  geom_point(aes(temp, ave_rate), d_ave5, size = 2, shape = 21, fill ="#FCBBA1")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave5) +
  geom_point(aes(temp, ave_rate), d_ave6, size = 2, shape = 21, fill ="#FC9272")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave6) +
  geom_point(aes(temp, ave_rate), d_ave7, size = 2, shape = 21, fill ="#FD8D3C")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave7) +
  geom_point(aes(temp, ave_rate), d_ave8, size = 2, shape = 21, fill ="#FB6A4A")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave8) +
  geom_point(aes(temp, ave_rate), d_ave9, size = 2, shape = 21, fill ="#EF3B2C")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave9) +
  geom_point(aes(temp, ave_rate), d_ave10, size = 2, shape = 21, fill ="#FC4E2A")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave10) +
  geom_point(aes(temp, ave_rate), d_ave11, size = 2, shape = 21, fill ="#E31A1C")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave11) +
  geom_point(aes(temp, ave_rate), d_ave12, size = 2, shape = 21, fill = "#CB181D")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave12) +
  geom_point(aes(temp, ave_rate), d_ave13, size = 2, shape = 21, fill ="#A50F15")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave13) +
  geom_point(aes(temp, ave_rate), d_ave14, size = 2, shape = 21, fill ="#BD0026")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave14) +
  geom_point(aes(temp, ave_rate), d_ave15, size = 2, shape = 21, fill ="#800026")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave15) +
  geom_point(aes(temp, ave_rate), d_ave16, size = 2, shape = 21, fill ="#67000D")+
  geom_linerange(aes(x = temp, ymin = ave_rate - sd, ymax = ave_rate + sd), d_ave16) +
  #Topt
  geom_point(data=data.frame(Topt=params1["T_opt"],Ropt= params1["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FFF5F0") +
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FEE0D2") +
  geom_point(data=data.frame(Topt=params3["T_opt"],Ropt= params3["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FFFFCC") +
  geom_point(data=data.frame(Topt=params4["T_opt"],Ropt= params4["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FFEDA0") +
  geom_point(data=data.frame(Topt=params5["T_opt"],Ropt= params5["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FCBBA1") +
  geom_point(data=data.frame(Topt=params6["T_opt"],Ropt= params6["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FC9272") +
  geom_point(data=data.frame(Topt=params7["T_opt"],Ropt= params7["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FD8D3C") +
  geom_point(data=data.frame(Topt=params8["T_opt"],Ropt= params8["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FB6A4A") +
  geom_point(data=data.frame(Topt=params9["T_opt"],Ropt= params9["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#EF3B2C") +
  geom_point(data=data.frame(Topt=params10["T_opt"],Ropt= params10["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FC4E2A") +
  geom_point(data=data.frame(Topt=params11["T_opt"],Ropt= params11["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#E31A1C") +
  geom_point(data=data.frame(Topt=params12["T_opt"],Ropt= params12["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#CB181D") +
  geom_point(data=data.frame(Topt=params13["T_opt"],Ropt= params13["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#A50F15") +
  geom_point(data=data.frame(Topt=params14["T_opt"],Ropt= params14["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#BD0026") +
  geom_point(data=data.frame(Topt=params15["T_opt"],Ropt= params15["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#800026") +
  geom_point(data=data.frame(Topt=params16["T_opt"],Ropt= params16["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#67000D") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. cerevisiae')+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SC
ggsave(filename = file.path(output_dir, "Figure_4H.tiff"), plot = SC, width = 6, height = 6, dpi = 300)
```

Plotting figure S7H

```{r figureS7H, fig.width=6, fig.height=6}
SC2 <- ggplot(R_predicted1) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray") +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#FEE0D2",R_predicted2) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted3) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted4) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted5) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted6) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted7) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#FB6A4A",R_predicted8) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted9) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted10) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted11) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted12) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#A50F15",R_predicted13) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted14) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted15) +
  geom_line(aes(x=T, y=Rate),linewidth=0.6,color="darkgray",R_predicted16) +
  #Topt
  geom_point(data=data.frame(Topt=params2["T_opt"],Ropt= params2["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FEE0D2") +
  geom_point(data=data.frame(Topt=params8["T_opt"],Ropt= params8["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#FB6A4A") +
  geom_point(data=data.frame(Topt=params13["T_opt"],Ropt= params13["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#A50F15") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold.italic",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate (OD/h)',
       title = 'S. cerevisiae')+
  annotate("text",x=28,y=0.7,label="Sc-2",fontface="bold",size=5, color="#FEE0D2",hjust = 0)+
  annotate("text",x=24,y=0.6,label="Sc-8",fontface="bold",size=5, color="#FB6A4A",hjust = 0)+
  annotate("text",x=30,y=0.74,label="Sc-13",fontface="bold",size=5, color="#A50F15",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.8))
SC2
ggsave(filename = file.path(output_dir, "Figure_S7C.tiff"), plot = SA2, width = 6, height = 6, dpi = 300)
```

Generation of figure S4

```{r figureS4, fig.width=12, fig.height=18}

Curve1 <- ggarrange(SE,SU,SA,SK,SJ,SM,SP,SC, 
                    labels = c("A", "B","C","D","E","F","G","H"),
                    ncol = 2, nrow = 4)

figureS4 <- annotate_figure(Curve1,
                top = text_grob("Thermal Performance Curves", color = "black", face = "bold", size = 16))
figureS4

ggsave(filename = file.path(output_dir, "Figure_S4.tiff"), plot = figureS4, width = 12, height = 18, dpi = 300)
```

Generation of figure S7
```{r figureS7, fig.width=12, fig.height=18}
Curve2 <- ggarrange(SE2,SU2,SA2,SK2,SJ2,SM2,SP2,SC2, 
                    labels = c("A", "B","C","D","E","F","G","H"),
                    ncol = 2, nrow = 4)

figureS7 <- annotate_figure(Curve2,
                top = text_grob("Selected strains", color = "black", face = "bold", size = 16))
figureS7

ggsave(filename = file.path(output_dir, "Figure_S7.tiff"), plot = figureS7, width = 12, height = 18, dpi = 300)
```

The shapes of the TPCs were largely species-dependent with uniform responses to temperature, e.g. only two of six *S. mikatae* strains showed different growth rates. 

Generation of TPCs based on species mean averaged across strains (Figure 2B)

```{r}
SU <- datos %>% filter(Specie == "SU", temp != "23")
head(SU)

ggplot() +
  geom_point(aes(temp, ave_rate), SU, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SU$temp %>% unlist()
R_observed <- SU$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SU <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
              start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SU

# Extract parameter estimates
paramsSU <- coef(fit_SU)

# Validate the model fit
summary(fit_SU)
calc_params(fit_SU)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SU <- CTMI(T_new, paramsSU["T_min"], paramsSU["T_opt"], paramsSU["T_max"], paramsSU["R_opt"])

# Visualize the results
R_predicted_SU <- data.frame(T=T_new, Rate = R_predicted_SU) 

ggplot(R_predicted_SU) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SU, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SU') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,40))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SU), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SU$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SU$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SU$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SU <- R_predicted_SU %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SU)

ggplot(R_predicted_SU) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SU') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## SE

SE <- datos %>% filter(Specie == "SE", temp != "23")
head(SE)

ggplot() +
  geom_point(aes(temp, ave_rate), SU, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SE$temp %>% unlist()
R_observed <- SE$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SE <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SE

# Extract parameter estimates
paramsSE <- coef(fit_SE)

# Validate the model fit
summary(fit_SE)
calc_params(fit_SE)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SE <- CTMI(T_new, paramsSE["T_min"], paramsSE["T_opt"], paramsSE["T_max"], paramsSE["R_opt"])

# Visualize the results
R_predicted_SE <- data.frame(T=T_new, Rate = R_predicted_SE) 

ggplot(R_predicted_SE) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SE, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SE') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SE), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SE$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SE$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SE$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SE <- R_predicted_SE %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SE)

ggplot(R_predicted_SE) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SE') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## SA

SA <- datos %>% filter(Specie == "SA", temp != "23")
head(SA)

ggplot() +
  geom_point(aes(temp, ave_rate), SA, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SA$temp %>% unlist()
R_observed <- SA$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SA <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SA

# Extract parameter estimates
paramsSA <- coef(fit_SA)

# Validate the model fit
summary(fit_SA)
calc_params(fit_SA)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SA <- CTMI(T_new, paramsSA["T_min"], paramsSA["T_opt"], paramsSA["T_max"], paramsSA["R_opt"])

# Visualize the results
R_predicted_SA <- data.frame(T=T_new, Rate = R_predicted_SA) 

ggplot(R_predicted_SA) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SA, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SA') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SA), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SA$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SA$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SA$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SA <- R_predicted_SA %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SA)

ggplot(R_predicted_SA) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SA') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## SK

SK <- datos %>% filter(Specie == "SK", temp != "23")
head(SK)

ggplot() +
  geom_point(aes(temp, ave_rate), SK, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SK$temp %>% unlist()
R_observed <- SK$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SK <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SK

# Extract parameter estimates
paramsSK <- coef(fit_SK)

# Validate the model fit
summary(fit_SK)
calc_params(fit_SK)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SK <- CTMI(T_new, paramsSK["T_min"], paramsSK["T_opt"], paramsSK["T_max"], paramsSK["R_opt"])

# Visualize the results
R_predicted_SK <- data.frame(T=T_new, Rate = R_predicted_SK) 

ggplot(R_predicted_SK) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SK, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SK') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SK), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SK$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SK$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SK$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SK <- R_predicted_SK %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SK)

ggplot(R_predicted_SK) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SK') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## Sj

SJ <- datos %>% filter(Specie == "SJ", temp != "34")
head(SJ)

ggplot() +
  geom_point(aes(temp, ave_rate), SJ, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SJ$temp %>% unlist()
R_observed <- SJ$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SJ <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SJ

# Extract parameter estimates
paramsSJ <- coef(fit_SJ)

# Validate the model fit
summary(fit_SJ)
calc_params(fit_SJ)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SJ <- CTMI(T_new, paramsSJ["T_min"], paramsSJ["T_opt"], paramsSJ["T_max"], paramsSJ["R_opt"])

# Visualize the results
R_predicted_SJ <- data.frame(T=T_new, Rate = R_predicted_SJ) 

ggplot(R_predicted_SJ) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SJ, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SJ') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SJ), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SJ$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SJ$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SJ$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SJ <- R_predicted_SJ %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SJ)

ggplot(R_predicted_SJ) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SJ') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## SM

SM <- datos %>% filter(Specie == "SM", temp != "23")
head(SM)

ggplot() +
  geom_point(aes(temp, ave_rate), SM, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SM$temp %>% unlist()
R_observed <- SM$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SM <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SM

# Extract parameter estimates
paramsSM <- coef(fit_SM)

# Validate the model fit
summary(fit_SM)
calc_params(fit_SM)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SM <- CTMI(T_new, paramsSM["T_min"], paramsSM["T_opt"], paramsSM["T_max"], paramsSM["R_opt"])

# Visualize the results
R_predicted_SM <- data.frame(T=T_new, Rate = R_predicted_SM) 

ggplot(R_predicted_SM) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SM, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SM') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SM), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SM$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SM$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SM$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SM <- R_predicted_SM %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SM)

ggplot(R_predicted_SM) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SM') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## SP

SP <- datos %>% filter(Specie == "SP", temp != "23")
head(SP)

ggplot() +
  geom_point(aes(temp, ave_rate), SP, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SP$temp %>% unlist()
R_observed <- SP$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SP <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SP

# Extract parameter estimates
paramsSP <- coef(fit_SP)

# Validate the model fit
summary(fit_SP)
calc_params(fit_SP)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SP <- CTMI(T_new, paramsSP["T_min"], paramsSP["T_opt"], paramsSP["T_max"], paramsSP["R_opt"])

# Visualize the results
R_predicted_SP <- data.frame(T=T_new, Rate = R_predicted_SP) 

ggplot(R_predicted_SP) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SP, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SP') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SP), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SP$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SP$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SP$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SP <- R_predicted_SP %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SP)

ggplot(R_predicted_SP) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SP') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

## SC

SC <- datos %>% filter(Specie == "SC", temp != "23")
head(SC)

ggplot() +
  geom_point(aes(temp, ave_rate), SC, size = 2, shape = 21, fill = 'green4') +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        strip.text = element_text(hjust = 0),
        strip.background = element_blank()) +
  labs(x ='Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rates across temperatures') +
  geom_hline(aes(yintercept = 0), linetype = 2)

T <- SC$temp %>% unlist()
R_observed <- SC$ave_rate %>% unlist()

# Fit the CTMI model to the data with adjusted starting values
fit_SC <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                start = list(T_min = 0, T_opt = 20, T_max = 37, R_opt = 0.25))
fit_SC

# Extract parameter estimates
paramsSC <- coef(fit_SC)

# Validate the model fit
summary(fit_SC)
calc_params(fit_SC)

# Make predictions
T_new <- seq(0, 42, by = 0.5)
R_predicted_SC <- CTMI(T_new, paramsSC["T_min"], paramsSC["T_opt"], paramsSC["T_max"], paramsSC["R_opt"])

# Visualize the results
R_predicted_SC <- data.frame(T=T_new, Rate = R_predicted_SC) 

ggplot(R_predicted_SC) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_point(aes(temp, ave_rate), SC, size = 2, shape = 21, fill ="black")+
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SC') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))

# Realizar boostrapping para obtener la distribución de los parámetros del modelo
n_bootstraps <- 1000  # Número de iteraciones de boostrapping
bootstrapped_parameters <- matrix(nrow = n_bootstraps, ncol = 4)  # Matriz para almacenar los parámetros de cada iteración

for (i in 1:n_bootstraps) {
  # Muestreo con reemplazo de los índices de los datos
  sampled_indices <- sample(1:length(R_observed), replace = TRUE)
  
  # Subconjunto de los datos observados
  subset_data <- data.frame(T = T[sampled_indices], R_observed = R_observed[sampled_indices])
  
  # Ajustar el modelo a los datos muestreados
  bootstrap_fit <- nlsLM(R_observed ~ CTMI(T, T_min, T_opt, T_max, R_opt),
                         start = coef(fit_SC), data = subset_data)
  
  # Guardar los parámetros ajustados
  bootstrapped_parameters[i, ] <- coef(bootstrap_fit)
}

# Visualizar la distribución de los parámetros
par(mfrow = c(2, 2))
for (j in 1:4) {
  hist(bootstrapped_parameters[, j], main = names(coef(fit_SU))[j], xlab = "")
}

for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}




# Crear la ventana de gráficos
par(mfrow = c(1, 1))

# Graficar la curva del modelo original
plot(T_new, R_predicted_SC$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")
lines(T_new, R_predicted_SC$Rate, col = "blue")

# Graficar las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  R_pred_boot <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
  lines(T_new, R_pred_boot, col = "gray", lty = 2)
}

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping"), col = c("blue", "gray"), lty = c(1, 2))

# Crear una matriz para almacenar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
bootstrapped_predictions <- matrix(NA, nrow = length(T_new), ncol = n_bootstraps)

# Generar las curvas de rendimiento térmico predichas para cada iteración de boostrapping
for (i in 1:n_bootstraps) {
  bootstrapped_predictions[, i] <- CTMI(T_new, bootstrapped_parameters[i, 1], bootstrapped_parameters[i, 2], bootstrapped_parameters[i, 3], bootstrapped_parameters[i, 4])
}

# Graficar la curva del modelo original
plot(T_new, R_predicted_SC$Rate, type = "l", col = "blue", xlab = "Temperatura", ylab = "Rendimiento Térmico", main = "Curva de Rendimiento Térmico")

# Superponer las curvas obtenidas mediante boostrapping
for (i in 1:n_bootstraps) {
  lines(T_new, bootstrapped_predictions[, i], col = "gray", lty = 2)
}

# Calcular y graficar el intervalo de confianza
lower_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.025)
upper_bound <- apply(bootstrapped_predictions, 1, quantile, probs = 0.975)
lines(T_new, apply(bootstrapped_predictions, 1, median), col = "red", lwd = 2)  # Mediana de las curvas de rendimiento térmico predichas
lines(T_new, lower_bound, col = "green", lwd = 2, lty = 2)  # Límite inferior del intervalo de confianza
lines(T_new, upper_bound, col = "green", lwd = 2, lty = 2)  # Límite superior del intervalo de confianza

# Agregar leyenda
legend("topright", legend = c("Modelo Original", "Boostrapping", "Intervalo de Confianza"), col = c("blue", "gray", "red", "green"), lty = c(1, 2, 1, 2), lwd = c(1, 1, 2, 2))

R_predicted_SC <- R_predicted_SC %>%
  mutate(lwr = lower_bound, upr = upper_bound)
head(R_predicted_SC)

ggplot(R_predicted_SC) +
  geom_line(aes(x=T, y=Rate), color = "blue") +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "deepskyblue4", alpha = 0.2) +
  theme_bw(base_size = 12) +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold"),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12)) +
  labs(x = 'Temperature (ºC)',
       y = 'Growth rate',
       title = 'Growth rate across temperatures for SC') +
  geom_hline(aes(yintercept = 0), linetype = 2) +
  scale_color_brewer(type = 'qual', palette = 2) +
  xlim(c(0,42))+
  ylim(c(0,0.8))
```

Plotting figure 2B

```{r figureS2V, fig.width=6, fig.height=6}
all<- ggplot(R_predicted_SE) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#08519C") +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#88419D",R_predicted_SU) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#238B45",R_predicted_SA) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#2B8CBE",R_predicted_SK) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#737373",R_predicted_SJ) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#980043",R_predicted_SM) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#D94801",R_predicted_SP) +
  geom_line(aes(x=T, y=Rate),linewidth=0.8,color="#CB181D",R_predicted_SC) +
  # CI
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#08519C", alpha = 0.2,R_predicted_SE) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#88419D", alpha = 0.2,R_predicted_SU) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#238B45", alpha = 0.2,R_predicted_SA) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#2B8CBE", alpha = 0.2,R_predicted_SK) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#737373", alpha = 0.2,R_predicted_SJ) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#980043", alpha = 0.2,R_predicted_SM) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#D94801", alpha = 0.2,R_predicted_SP) +
  geom_ribbon(aes(x= T,ymin = lwr, ymax = upr), fill = "#CB181D", alpha = 0.2,R_predicted_SC) +
  #Topt
  geom_point(data=data.frame(Topt=paramsSE["T_opt"],Ropt= paramsSE["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#08519C") +
  geom_point(data=data.frame(Topt=paramsSU["T_opt"],Ropt= paramsSU["R_opt"]),aes(x=29.32,y=0.447), size = 4,  color="#88419D") +
  geom_point(data=data.frame(Topt=paramsSA["T_opt"],Ropt= paramsSA["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#238B45") +
  geom_point(data=data.frame(Topt=paramsSK["T_opt"],Ropt= paramsSK["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#2B8CBE") +
  geom_point(data=data.frame(Topt=paramsSJ["T_opt"],Ropt= paramsSJ["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#737373") +
  geom_point(data=data.frame(Topt=paramsSM["T_opt"],Ropt= paramsSM["R_opt"]),aes(x=31.24,y=0.567), size = 4,  color="#980043") +
  geom_point(data=data.frame(Topt=paramsSP["T_opt"],Ropt= paramsSP["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#D94801") +
  geom_point(data=data.frame(Topt=paramsSC["T_opt"],Ropt= paramsSC["R_opt"]),aes(x=Topt,y=Ropt), size = 4,  color="#CB181D") +
  #Resto
  theme_bw() +
  theme(legend.position = 'none',
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14)) +
  labs(x = 'Temperature (ºC)',
       y = 'Maximum growth rate (OD/h)',
       title = 'Thermal Performance Curves')+
  annotate("text",x=0,y=0.7,label="S. cerevisiae",fontface="italic",size=5, color="#CB181D",hjust = 0)+
  annotate("text",x=0,y=0.67,label="S. paradoxus",fontface="italic",size=5, color="#D94801",hjust = 0)+
  annotate("text",x=0,y=0.64,label="S. mikatae",fontface="italic",size=5, color="#980043",hjust = 0)+
  annotate("text",x=0,y=0.58,label="S. uvarum",fontface="italic",size=5, color="#88419D",hjust = 0)+
  annotate("text",x=0,y=0.55, label="S. arboricola",fontface="italic",size=5, color="#238B45",hjust = 0)+
  annotate("text",x=0,y=0.61,label="S. jurei",fontface="italic",size=5, color="#737373",hjust = 0)+
  annotate("text",x=0,y=0.49,label="S. eubyanus",fontface="italic",size=5, color="#08519C",hjust = 0)+
  annotate("text",x=0,y=0.52,label="S. kudriavzevii",fontface="italic",size=5, color="#2B8CBE",hjust = 0)+
  xlim(c(0,42))+
  ylim(c(0,0.7))
all
ggsave(filename = file.path(output_dir, "Figure_2B.tiff"), plot = all, width = 6, height = 6, dpi = 300)
```

**Plotting and analyzing thermal parameters**

**Loading data**
```{r}
file_path <- file.path(input_dir, "Thermal_performance.txt")
datos <- read.table(file_path, header = TRUE, stringsAsFactors = FALSE)
datos$Specie <- ordered(datos$Specie, levels = c("SE", "SU", "SA", "SK", "SJ","SM","SP","SC"))
head(datos)
```

Optimum temperature

```{r figure2C1, fig.width=6, fig.height=3}
topt <- datos %>% 
  mutate(Specie = reorder(Specie, topt, FUN = mean)) %>%
  ggplot(aes(x=Specie,y=topt,col=Specie)) +
  geom_point(stat='identity', size=6, alpha=0.3)  +
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1),geom="pointrange", aes(color=Specie),size = 1, linewidth=1)+
  scale_color_manual(values = c("#08519C","#2B8CBE","#238B45","#88419D","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "S. eubayanus","SK" = "S. kudriavzevii","SA" = "S. arboricola","SU" = "S. uvarum","SJ" = "S. jurei", 
                              "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"),
                     name = "Specie") +
  ylab("Temperature (°C)") +
  xlab("") +
  ggtitle("Optimum temperature") +
  scale_x_discrete(labels=c("SE" = "S. eubayanus","SK" = "S. kudriavzevii","SA" = "S. arboricola", "SU" = "S. uvarum","SJ" = "S. jurei",
                            "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"))+
  scale_y_continuous(limits = c(22,38),breaks = seq(22,38,4))+
  theme_bw() +
  theme(axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14,face = 'italic'),
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        legend.position = 'none') +
  coord_flip()
topt

ggsave(filename = file.path(output_dir, "Figure_2C1.tiff"), plot = topt, width = 6, height = 3, dpi = 300)
```

Maximum performance
```{r figure2C2, fig.width=6, fig.height=3}
rmax <- datos %>% 
  mutate(Specie = reorder(Specie, rmax, FUN = mean)) %>%
  ggplot(aes(x=Specie,y=rmax,col=Specie)) +
  geom_point(stat='identity', size=6, alpha=0.3)  +
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1),geom="pointrange", aes(color=Specie),size = 1, linewidth=1)+
  scale_color_manual(values = c("#2B8CBE","#238B45","#08519C","#88419D","#D94801","#737373","#980043","#CB181D"),
                     labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SE" = "S. eubayanus", "SU" = "S. uvarum",
                              "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae","SJ" = "S. jurei"),
                     name = "Specie") +
  ylab("Growth rate") +
  xlab("") +
  ggtitle("Maximum performance") +
  scale_x_discrete(labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SJ" = "S. jurei","SE" = "S. eubayanus", "SU" = "S. uvarum",
                            "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"))+
  #scale_y_continuous(limits = c(2,12),breaks = seq(2,12,2))+
  theme_bw() +
  theme(axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14,face = 'italic'),
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        legend.position = 'none') +
  coord_flip()
rmax
ggsave(filename = file.path(output_dir, "Figure_2C2.tiff"), plot = rmax, width = 6, height = 3, dpi = 300)
```

Upper thermal limit
```{r figureS5A, fig.width=6, fig.height=4}
ctmax <- datos %>% 
  mutate(Specie = reorder(Specie, ctmax, FUN = mean)) %>%
  ggplot(aes(x=Specie,y=ctmax,col=Specie)) +
  geom_point(stat='identity', size=6, alpha=0.3)  +
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1),geom="pointrange", aes(color=Specie),size = 1, linewidth=1)+
  scale_color_manual(values = c("#2B8CBE","#08519C","#238B45","#737373","#88419D","#980043","#D94801","#CB181D"),
                     labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SE" = "S. eubayanus","SU" = "S. uvarum",
                              "SJ" = "S. jurei","SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"),
                     name = "Specie") +
  ylab("Temperature (°C)") +
  xlab("") +
  ggtitle("Upper Thermal Limit") +
  scale_x_discrete(labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SJ" = "S. jurei","SE" = "S. eubayanus", "SU" = "S. uvarum",
                            "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"))+
  theme_bw() +
  theme(axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14),
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16),
        strip.text.x = element_text(size=12,face="bold"),
        legend.position = 'none') +
  scale_y_continuous(limits = c(26,42),breaks = seq(26,42,2))+
  coord_flip()
ctmax
ggsave(filename = file.path(output_dir, "Figure_S5A.tiff"), plot = SA2, width = 6, height = 4, dpi = 300)
```


Lower thermal limit
```{r figureS5B, fig.width=6, fig.height=4}
ctmin <- datos %>% 
  mutate(Specie = reorder(Specie, ctmin, FUN = mean)) %>%
  ggplot(aes(x=Specie,y=ctmin,col=Specie)) +
  geom_point(stat='identity', size=6, alpha=0.3)  +
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1),geom="pointrange", aes(color=Specie),size = 1, linewidth=1)+
  scale_color_manual(values = c("#737373","#238B45","#88419D","#2B8CBE","#08519C","#980043","#D94801","#CB181D"),
                     labels=c("SJ" = "S. jurei","SU" = "S. uvarum","SC"="S. cerevesiae","SP"="S. paradoxus",
                              "SK" = "S. kudriavzevii","SE" = "S. eubayanus","SM" = "S. mikatae","SA" = "S. arboricola"),
                     name = "Specie") +
  ylab("Temperature (°C)") +
  xlab("") +
  ggtitle("Lower Thermal Limit") +
  scale_x_discrete(labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SJ" = "S. jurei","SE" = "S. eubayanus", "SU" = "S. uvarum",
                            "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"))+
  theme_bw() +
  theme(axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14),
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16),
        strip.text.x = element_text(size=12,face="bold"),
        legend.position = 'none') +
  scale_y_continuous(limits = c(0,12),breaks = seq(0,12,2))+
  coord_flip()
ctmin
ggsave(filename = file.path(output_dir, "Figure_S5B.tiff"), plot = SA2, width = 6, height = 4, dpi = 300)
```

Thermal breadth
```{r figureS5C, fig.width=6, fig.height=4}
breadth <- datos %>% 
  mutate(Specie = reorder(Specie, breadth, FUN = mean)) %>%
  ggplot(aes(x=Specie,y=breadth,col=Specie)) +
  geom_point(stat='identity', size=6, alpha=0.3)  +
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1),geom="pointrange", aes(color=Specie),size = 1, linewidth=1)+
  scale_color_manual(values = c("#2B8CBE","#08519C","#238B45","#980043","#88419D","#D94801","#737373","#CB181D"),
                     labels=c("SK" = "S. kudriavzevii","SE" = "S. eubayanus","SA" = "S. arboricola", "SM" = "S. mikatae","SU" = "S. uvarum",
                              "SP"="S. paradoxus","SJ" = "S. jurei","SC"="S. cerevesiae"),
                     name = "Specie") +
  ylab("Temperature (°C)") +
  xlab("") +
  ggtitle("Thermal Breadth") +
  scale_x_discrete(labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SJ" = "S. jurei","SE" = "S. eubayanus", "SU" = "S. uvarum",
                            "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"))+
  scale_y_continuous(limits = c(2,14),breaks = seq(2,14,2))+
  theme_bw() +
  theme(axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14,face = 'italic'),
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        legend.position = 'none') +
  coord_flip()
breadth
ggsave(filename = file.path(output_dir, "Figure_S5C.tiff"), plot = SA2, width = 6, height = 4, dpi = 300)
```

Thermal tolerance
```{r figureS5D, fig.width=6, fig.height=4}
tolerance<- datos %>% 
  mutate(Specie = reorder(Specie, thermal_tolerance, FUN = mean)) %>%
  ggplot(aes(x=Specie,y=thermal_tolerance,col=Specie)) +
  geom_point(stat='identity', size=6, alpha=0.3)  +
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1),geom="pointrange", aes(color=Specie),size = 1, linewidth=1)+
  scale_color_manual(values = c("#2B8CBE","#08519C","#238B45","#88419D","#980043","#D94801","#CB181D","#737373"),
                     labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SE" = "S. eubayanus","SU" = "S. uvarum",
                              "SJ" = "S. jurei","SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"),
                     name = "Specie") +
  ylab("Temperature (°C)") +
  xlab("") +
  ggtitle("Thermal Tolerance") +
  scale_x_discrete(labels=c("SK" = "S. kudriavzevii","SA" = "S. arboricola","SJ" = "S. jurei","SE" = "S. eubayanus", "SU" = "S. uvarum",
                            "SM" = "S. mikatae","SP"="S. paradoxus","SC"="S. cerevesiae"))+
  theme_bw() +
  theme(axis.title.y = element_text( size = 14),
        axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14), 
        axis.text.y = element_text(size = 14),
        plot.title = element_text(size = 16,face = "bold",hjust = 0.5),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16),
        strip.text.x = element_text(size=12,face="bold"),
        legend.position = 'none') +
  scale_y_continuous(limits = c(22,42),breaks = seq(22,42,4))+
  coord_flip()
tolerance
ggsave(filename = file.path(output_dir, "Figure_S5D.tiff"), plot = SA2, width = 6, height = 4, dpi = 300)
```

Plotting figure S5
```{r figureS5, fig.width=12, fig.height=8}
Curve1 <- ggarrange(ctmax,ctmin,breadth,tolerance,
                    labels = c("A", "B","C", "D"),
                    ncol = 2, nrow = 2, common.legend = TRUE, legend = "none")

figureS5 <- annotate_figure(Curve1,
                top = text_grob("Thermal Performance Curves Parameters", color = "black", face = "bold", size = 16))
figureS5

ggsave(filename = file.path(output_dir, "Figure_S5.tiff"), plot = figureS5, width = 12, height = 8, dpi = 300)
```

**Correltaion between thermal parameters**

```{r}
c1 <- datos %>% 
  ggplot(aes(x=topt,y=rmax))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                    labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                             "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                    name = "Species") +
  xlab("Optimum temperature (°C)")+
  ylab("Max. performance (OD/h)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c1  

c2 <- datos %>% 
  ggplot(aes(x=topt,y=thermal_tolerance))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                              "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                     name = "Species") +
  xlab("Optimum temperature (°C)")+
  ylab("Thermal tolerance (°C)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c2

c3 <- datos %>% 
  ggplot(aes(x=topt,y=ctmax))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                              "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                     name = "Species") +
  xlab("Optimum temperature (°C)")+
  ylab("CTmax (°C)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c3



c5 <- datos %>% 
  ggplot(aes(x=topt,y=breadth))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                              "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                     name = "Species") +
  xlab("Optimum temperature (°C)")+
  ylab("Thermal breadth (°C)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c5

c6 <- datos %>% 
  ggplot(aes(x=rmax,y=ctmax))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                              "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                     name = "Species") +
  xlab("Max. performance (OD/h)")+
  ylab("CTmax (°C)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c6


c8 <- datos %>% 
  ggplot(aes(x=ctmax,y=ctmin))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                              "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                     name = "Species") +
  xlab("CTmax (°C)")+
  ylab("CTmin (°C)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c8

c9 <- datos %>% 
  ggplot(aes(x=rmax,y=breadth))+
  geom_point(aes(color=Specie), size=3)+
  geom_smooth(method = "lm", se=TRUE, color="black")+
  scale_color_manual(values = c("#08519C","#88419D","#238B45","#2B8CBE","#737373","#980043","#D94801","#CB181D"),
                     labels=c("SE" = "Se", "SU" = "Su", "SA" = "Sa",
                              "SK" = "Sk", "SJ" = "Sj", "SM" = "Sm", "SP"="Sp","SC"="Sc"),
                     name = "Species") +
  xlab("Maximum performance (OD/h)")+
  ylab("Thermal breadth (°C)")+
  theme_bw()+
  theme(axis.title.x = element_text( size = 14),
        axis.text.x = element_text(size = 14),
        axis.title.y = element_text( size = 14),
        axis.text.y = element_text(size = 14),
        legend.text = element_text(size = 16), legend.title = element_text(size = 16)) 
c9
```

Plotting figure 2D
```{r figure2D, fig.width=6, fig.height=6}
Curve2 <- ggarrange(c1,c2,
                    ncol = 1, nrow = 2, common.legend = TRUE, legend = "bottom")
Curve2
ggsave(filename = file.path(output_dir, "Figure_2D.tiff"), plot = Curve2, width = 6, height = 6, dpi = 300)
```

Plotting figure S6
```{r figureS6, fig.width=8, fig.height=12}
figureS6 <- ggarrange(c3,c5,c6,c9,c8, 
                                labels = c("A", "B","C","D","E"),
                                ncol = 2, nrow = 3, common.legend = TRUE, legend = "bottom")
figureS6
ggsave(filename = file.path(output_dir, "Figure_S6.tiff"), plot = figureS6, width = 8, height = 12, dpi = 300)
```
We found significant positive correlations between thermal parameters (Figure 2D and S6; Pearson correlation, p < 0.05). The strongest correlations were between Topt with Pmax, CTmax, and thermal tolerance (R2 = 0.87, 0.86, and 0.7, respectively) and Pmax with CTmax (R2 = 0.74). Thus, species with higher CTmax also have higher Topt and Pmax. 

Together, the TPCs we observed across species (before experimental evolution was applied), suggest that the natural genetic diversity in temperature tolerance contained in the Saccharomyces genus produces a “hotter is better and wider” pattern, where warm-adapted species grow faster at high temperatures and have a wider range of growth temperatures. 
